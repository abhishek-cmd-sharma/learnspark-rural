<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firestore Integration Test</title>
    <script type="importmap">
        {
            "imports": {
                "firebase/app": "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js",
                "firebase/firestore": "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"
            }
        }
    </script>
</head>
<body>
    <h1>Firestore Integration Test</h1>
    <div id="results"></div>

    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'firebase/app';
        import { getFirestore, collection, getDocs } from 'firebase/firestore';

        // Firebase configuration (replace with your config)
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID",
            measurementId: "YOUR_MEASUREMENT_ID"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Test function
        async function testFirestore() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Testing Firestore integration...</p>';

            try {
                // Test fetching subjects
                const subjectsQuery = collection(db, 'subjects');
                const subjectsSnapshot = await getDocs(subjectsQuery);
                const subjects = [];
                subjectsSnapshot.forEach((doc) => {
                    subjects.push({ id: doc.id, ...doc.data() });
                });

                // Test fetching achievements
                const achievementsQuery = collection(db, 'achievements');
                const achievementsSnapshot = await getDocs(achievementsQuery);
                const achievements = [];
                achievementsSnapshot.forEach((doc) => {
                    achievements.push({ id: doc.id, ...doc.data() });
                });

                // Display results
                resultsDiv.innerHTML = `
                    <h2>Test Results</h2>
                    <p>✅ Firestore integration successful!</p>
                    <h3>Subjects (${subjects.length})</h3>
                    <ul>
                        ${subjects.map(subject => `<li>${subject.name}</li>`).join('')}
                    </ul>
                    <h3>Achievements (${achievements.length})</h3>
                    <ul>
                        ${achievements.map(achievement => `<li>${achievement.title}</li>`).join('')}
                    </ul>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `<p>❌ Error: ${error.message}</p>`;
                console.error('Firestore test error:', error);
            }
        }

        // Run the test
        testFirestore();
    </script>
</body>
</html>